<!doctype html>

<!--
    Created by philnash supported by Twilio
    See https://github.com/philnash/jsconf-schedule
-->

<html generated="{{ Date.now() }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>JSConf EU Schedule 2018</title>
  <meta name="viewport" content="width=device-width">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="JSConf EU schedule">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/manifest-json.txt">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#303f62">

  <style id="style">
h1,
h2,
h3,
h4,
h5,
h6 {
  font-weight: normal;
}
body,
html {
  height: 100%;
  padding: 0;
  margin: 0;
}
html {
  font-size: 16px;
}
body {
  font-family: Verdana, sans-serif;
  line-height: 1.5;
  color: #bbbbbb;
  background-color: #0C1222;
}
a {
  -webkit-transition: color 0.3s, background-color 0.5s;
  -moz-transition: color 0.3s, background-color 0.5s;
  -o-transition: color 0.3s, background-color 0.5s;
  transition: color 0.3s, background-color 0.5s;
  color: #ff0079;
}
header {
  overflow: hidden;
  position: fixed;
  top: 0;
  width: 100%;
  text-align: center;
  color: #FCFFFF;
  background: #0C1222 url({{ contents.svg['schedule-header.svg'].url }}) no-repeat 0 -442px;
  z-index: 10;
}
header h1 {
  margin: 10px 0;
  font-size: 16px;
}
footer {
  position: fixed;
  bottom: 0;
  width: 100%;
  padding: 0 20px;
  background: #0C1222;
}
footer a {
  color:#91a1bc;
}
nav {
  display: flex;
  font-size: 14px;
  border-bottom: 5px solid #0C1222;
}
nav a {
  display: inline-block;
  flex-grow: 1;
  justify-content: space-around;
  margin:0 5px;
  padding: 5px 0;
  text-align: center;
  text-decoration: none;
  color: #fff;
  border-bottom: 3px solid transparent;
  transition: border-color 0.3s;
}
nav a.active {
  border-color: #051ADD;
}
.events {
  padding: 0;
  margin: 0;
  list-style: none;
}
.day {
  padding-top: 93px;
  padding-bottom: 46px;
}

.day h2 {
  margin: 0;
  padding: 4px 20px;
  color: #fff;
  background: #333;
}
.day li {
  padding: 0 10px;
}
.day .time {
  margin-top: 0;
  text-align: center;
  font-size: 12px;
  /*visibility: hidden;*/
  height: 0;
}
.day .time * {
  display: none;
}
.day .session {
  margin: 20px;
  display: flex;
  position: relative;
  overflow-x: hidden;
}
.day .session::before{
  content: '';
  background-color: #ff0079;
  flex: 0 0 8px;
  border-radius: 5px;
  margin-right: 20px;
  margin-left: 35px;
}
.day .session.side::before {
  background-color: #051ADD;
}
.day .session time {
  position: absolute;
  top: 12px;
  left:0;
  font-size: 12px;
}
.day .session div time {
  top: 14px;
}
.day .session h3 {
  margin-top: 0;
  margin-bottom: 0;
  color: #91a1bc;
}
.day .session h3 .speaker {
  display: block;
  font-size: 14px;
  color:#FCFFFF;
}
.day .session a,
.day .session > div {
  text-decoration: none;
  color: #FCFFFF;
  padding-top: 10px;
  padding-bottom: 10px;
}
article.with-description {
  cursor: pointer
}
.day .session article.with-description:not(.active) h3::after {
  display: block;
  font-size: 12px;
  content: 'Â» Details';
  padding: 5px 0;
}
.day .session article > p,
.day .session div > p {
  margin:0;
}
.day .session .description {
  display: none;
  padding-top: .5em;
  padding-bottom: 0;
}
.day .session .active .description,
.day .session .active + .description {
  display: block;
}
.day .session .description p {
  line-height: 1.5;
  margin-bottom: .5em;
}
.day .session .description p:last-child{
  margin-bottom: 0;
}
.day .session .description ul {
  margin: 0;
  padding: 0;
}
.day .session .description ul li {
  line-height: 1.2;
  margin: 0 0 .5em 0;
  padding: 0;
  list-style-position: inside;
  list-style-type: disc;
}
.day .session .description a {
  text-decoration: underline;
}
.message {
  padding: 6px 20px;
  text-align: center;
}

.notice {
  position:fixed;
  bottom:0px;
  width:100%;
  color: #fff;
  padding:0 20px;
  background-color: #ff0079;
  opacity: 1;
  visibility: visible;
  transition: visibility 0s, opacity 0.5s ease-in-out;
}
.notice[hidden] {
  opacity: 0;
  display: block;
  visibility: hidden;
}
.notice a{
  color: #fff;
}

  </style>

</head>

<body>
  <header>
    <h1><a href="/">Home</a></h1>
    <nav>
      <a href="#day1" id="nav_day1">JSConf Day 1</a>
      <a href="#day2" id="nav_day2">JSConf Day 2</a>
    </nav>
  </header>
  {% for day, sessions in schedule.schedule %}
    <div class="day {% if schedule.info.currentDay == day %}active{% endif %}" id="day{{ day }}">
    <h2>Day {{ day }}</h2>
    <ul class="events">
      {% for session, talks in sessions %}
        <li class="time" id="day{{ day }}-{{ session | replace('.', '-') }}">
          <h3>{{ session }}</h3>
        </li>
        {% set talkIndex = 0 %}
        {% for talk in talks %}
          {% set talkIndex = talkIndex + 1 %}
          {% set talkPage = '' %}
          {% for page in contents.speakers._.pages %}
            {% if page.metadata.speaker.name == talk.who %}
              {% set talkPage = page %}
            {% endif %}
            {% if page.metadata.speaker.talkTitle == talk.what %}
              {% set talkPage = page %}
            {% endif %}
          {% endfor %}
          <li
              datetime="{{ talk.date }} {{ talk.startTime | replace('.', ':') }} GMT+0200"
              class="session {% if talk.track == 'Side Track' %}side{% endif %}"
              {% if talkPage %}
                id="talk-{{ talkPage.metadata.speaker.id }}"
              {% else %}
                id="talk-{{ talk.date }}-{{ talk.startTime | replace('.', '-') }}-{{ talkIndex }}"
              {% endif %}
              >

            <article {% if talkPage %}class="with-description"{% endif %} onclick="this.classList.toggle('active')">
              <h3>
                {% if talk.who %}
                  <span class="speaker">{{ talk.who }}</span>
                {% endif %}
                {{ talk.what }}
              </h3>
              {% if talk.who == 'all' %}
                <time>{{ session }}</time>
              {% else %}
              <p>
                <time>{{ session }}</time> {{ talk.track }}
              </p>
              {% endif %}
              {% if talkPage %}
                <div class="description">
                  {{ talkPage.html }}
                  <p><a href="{{ talkPage.url }}">More info</a></p>
                </div>
              {% endif %}
            </article>
          </li>
        {% endfor %}
      {% endfor %}
    </ul>
    </div>
  {% endfor %}
  <div class="notice" hidden id="notice">
    <p>The schedule was automatically updated.</p>
  </div>


<script id="inline">
document.body.className = 'js';

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js');
}

Array.from(document.querySelector('nav').children).forEach(function(btn) {
  btn.onclick = function(e) {
    setTimeout(function() {
      history.replaceState(null, null, '/schedule/')
    }, 100)
  };
});

function scrollTimeIntoView(onload) {
  // var now = new Date('2018-06-02 14:20 GMT+0200');
  var now = new Date();
  if (now.getTime() < Date.parse('2018-06-02 0:00 GMT+0200') ||
      now.getTime() > Date.parse('2018-06-04 0:00 GMT+0200')) {
    // Only scroll into view on the day off.
    return;
  }
  Array.from(document.querySelectorAll('[datetime]')).forEach(function(talk) {
    var time = new Date(Date.parse(talk.getAttribute('datetime')));
    if (time < now) {
      talk.classList.add('in-the-past')
    }
  });

  var firstFuture = document.querySelector('.session:not(.in-the-past)');
  setTimeout(function() {
    if (onload && document.documentElement.scrollTop != 0) {
      return;
    }
    firstFuture.scrollIntoView();
    document.documentElement.scrollTop -= 93;
  }, 100)
}

function checkCurrent() {
  fetch('/schedule/', {cache: 'reload'}).then(function(response) {
    if (response.ok) {
      response.text().then(function(text) {
        var generationTime = text.match(/<html generated=(\d+)/)[1];
        if (!generationTime) {
          console.error('Failed to find generation time', text);
          return;
        }
        if (generationTime != document.documentElement.getAttribute('generated')) {
          console.info('Updating schedule', generationTime);
          setDOM(document, text);
          document.querySelector('.notice').removeAttribute('hidden');
          setTimeout(function() {
             document.querySelector('.notice').setAttribute('hidden', '');
          }, 6000)
        } else {
          console.info('Schedule current', generationTime);
        }
      });
    } else {
      console.error('Check failed', response);
    }
  });
}

document.addEventListener('DOMContentLoaded', checkCurrent);
window.addEventListener('focus', checkCurrent);
document.addEventListener('DOMContentLoaded', scrollTimeIntoView.bind(null, true))
document.addEventListener('visibilitychange', function() {
  if (!document.hidden) {
    scrollTimeIntoView();
  }
})
setInterval(checkCurrent, 1000 * 60 * 5);  // Check every 5 minutes

</script>

<script id="setDOM">
// setDOM from https://github.com/DylanPiercey/set-dom under MIT License
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).setDOM=e()}}(function(){return function e(t,n,r){function i(d,a){if(!n[d]){if(!t[d]){var f="function"==typeof require&&require;if(!a&&f)return f(d,!0);if(o)return o(d,!0);var u=new Error("Cannot find module '"+d+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[d]={exports:{}};t[d][0].call(l.exports,function(e){var n=t[d][1][e];return i(n||e)},l,l.exports,e,t,n,r)}return n[d].exports}for(var o="function"==typeof require&&require,d=0;d<r.length;d++)i(r[d]);return i}({1:[function(e,t){"use strict";function n(e,t){!function(e,t){if(!e)throw new Error("set-dom: "+t)}(e&&e.nodeType,"You must provide a valid node to update."),e.nodeType===h&&(e=e.documentElement),t.nodeType===v?i(e,t):r(e,"string"==typeof t?s(t,e.nodeName):t),e[m]||(e[m]=!0,f(e))}function r(e,t){if(e.nodeType===t.nodeType)if(e.nodeType===p){if(function(e,t){return a(e)&&a(t)||d(e)===d(t)||e.isEqualNode(t)}(e,t))return;if(i(e,t),e.nodeName===t.nodeName)!function(e,t){var n,r,i,o,d;for(n=e.length;n--;)r=e[n],o=r.namespaceURI,d=r.localName,(i=t.getNamedItemNS(o,d))||e.removeNamedItemNS(o,d);for(n=t.length;n--;)r=t[n],o=r.namespaceURI,d=r.localName,(i=e.getNamedItemNS(o,d))?i.value!==r.value&&(i.value=r.value):(t.removeNamedItemNS(o,d),e.setNamedItemNS(r))}(e.attributes,t.attributes);else{for(var n=t.cloneNode();e.firstChild;)n.appendChild(e.firstChild);e.parentNode.replaceChild(n,e)}}else e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue);else e.parentNode.replaceChild(t,u(e)),f(t)}function i(e,t){for(var n,i,d,a,l,s,c=e.firstChild,m=t.firstChild,p=0;c;)p++,i=o(n=c),c=c.nextSibling,i&&(s||(s={}),s[i]=n);for(c=e.firstChild;m;)p--,d=m,m=m.nextSibling,s&&(a=o(d))&&(l=s[a])?(delete s[a],l!==c?e.insertBefore(l,c):c=c.nextSibling,r(l,d)):c?(n=c,c=c.nextSibling,o(n)?(e.insertBefore(d,n),f(d)):r(n,d)):(e.appendChild(d),f(d));for(i in s)p--,e.removeChild(u(s[i]));for(;--p>=0;)e.removeChild(u(e.lastChild))}function o(e){if(e.nodeType===p){var t=e.getAttribute(n.KEY)||e.id;return t?c+t:void 0}}function d(e){return e.getAttribute(n.CHECKSUM)||NaN}function a(e){return null!=e.getAttribute(n.IGNORE)}function f(e){return l(e,"mount")}function u(e){return l(e,"dismount")}function l(e,t){if(o(e)){var n=document.createEvent("Event"),r={value:e};n.initEvent(t,!1,!1),Object.defineProperty(n,"target",r),Object.defineProperty(n,"srcElement",r),e.dispatchEvent(n)}for(var i=e.firstChild;i;)i=l(i,t).nextSibling;return e}n.KEY="data-key",n.IGNORE="data-ignore",n.CHECKSUM="data-checksum";var s=e(2),c="_set-dom-",m=c+"mounted",p=1,h=9,v=11;t.exports=n},{2:2}],2:[function(e,t){"use strict";function n(e,t){if(t===i){if(d)return c.innerHTML=e,c;var n=e.match(p);if(n){var o=n[2],a=n.index+n[1].length,u=a+o.length;e=e.slice(0,a)+e.slice(u),m.innerHTML=o}for(var l=r.parseFromString(e,f),s=l.body;m.firstChild;)s.appendChild(m.firstChild);return l.documentElement}return m.innerHTML=e,m.firstChild}var r=window.DOMParser&&new window.DOMParser,i="HTML",o=!1,d=!1,a="text/html",f="application/xhtml+xml";try{var u=r.parseFromString('<wbr class="A"/>',a).body.firstChild,l=document.createElement("div");if(l.appendChild(u),"A"!==l.firstChild.classList[0])throw new Error;o=!0}catch(e){}var s=document.implementation.createHTMLDocument(""),c=s.documentElement,m=s.body;try{c.innerHTML+="",d=!0}catch(e){r.parseFromString('<wbr class="A"/>',f);var p=/(<body[^>]*>)([\s\S]*)<\/body>/}t.exports=o?function(e,t){var o=r.parseFromString(e,a);return o.body?t===i?o.documentElement:o.body.firstChild:n(e,t)}:n},{}]},{},[1])(1)});
</script>

</body>
</html>
